\hypertarget{classPrimality}{}\doxysection{Primality Class Reference}
\label{classPrimality}\index{Primality@{Primality}}


{\ttfamily \#include $<$primes.\+hpp$>$}

\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
bool \mbox{\hyperlink{classPrimality_aa00343cb6fa77239717833d27f201f03}{is\+\_\+prime}} (int n)
\item 
bool \mbox{\hyperlink{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}{compute\+\_\+miller\+\_\+rabin}} (int d, int n)
\item 
bool \mbox{\hyperlink{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}{miller\+\_\+rabin\+\_\+prime}} (int n, int iters)
\item 
void \mbox{\hyperlink{classPrimality_ab0da263da6230ef57e1d3ca3471b88d9}{miller\+\_\+rabin}} (int inters, int min\+\_\+val, int max\+\_\+val)
\item 
int \mbox{\hyperlink{classPrimality_a7bd351acce09b9003b38519d992a25ed}{jacobian\+\_\+number}} (long long a, long long n)
\item 
bool \mbox{\hyperlink{classPrimality_a8705a1468d5a995f5e835a0b992fae28}{solovoy\+\_\+strassen}} (long long p, int iters)
\item 
long long int \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\+\_\+pow}} (long long int base, long long int exponent, long long int mod)
\item 
bool \mbox{\hyperlink{classPrimality_aa37d71124bce59af692d285d7c370983}{carmichael\+\_\+num}} (int n)
\item 
void \mbox{\hyperlink{classPrimality_a0696ffc0cfa107f7231349e1a6f6a72c}{sieve\+\_\+of\+\_\+eratosthenes}} (int n)
\item 
long long int \mbox{\hyperlink{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}{pollard\+\_\+rho}} (long long int n)
\item 
int \mbox{\hyperlink{classPrimality_a334ba4925bdd37b5f6dfea94465afb1b}{ETF}} (unsigned int n)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{primes_8hpp_source_l00011}{11}} of file \mbox{\hyperlink{primes_8hpp_source}{primes.\+hpp}}.



\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classPrimality_aa37d71124bce59af692d285d7c370983}\label{classPrimality_aa37d71124bce59af692d285d7c370983}} 
\index{Primality@{Primality}!carmichael\_num@{carmichael\_num}}
\index{carmichael\_num@{carmichael\_num}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{carmichael\_num()}{carmichael\_num()}}
{\footnotesize\ttfamily bool Primality\+::carmichael\+\_\+num (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00202}{202}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00202                                     \{}
\DoxyCodeLine{00203     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} b = 2; b < n; b++) \{}
\DoxyCodeLine{00204         \textcolor{comment}{// If "{}b"{} is relatively prime to n}}
\DoxyCodeLine{00205         \textcolor{keywordflow}{if} (\mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}.\mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{op\_gcd}}(b, n) == 1)}
\DoxyCodeLine{00206             \textcolor{comment}{// And pow(b, n-\/1)\%n is not 1, return false.}}
\DoxyCodeLine{00207             \textcolor{keywordflow}{if} (\mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(b, n -\/ 1, n) != 1)}
\DoxyCodeLine{00208                 \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00209     \}}
\DoxyCodeLine{00210     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00211 \}}

\end{DoxyCode}


References \mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}, \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\+\_\+pow()}}, and \mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{mtpk\+::\+Basics\+::op\+\_\+gcd()}}.

\mbox{\Hypertarget{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}\label{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}} 
\index{Primality@{Primality}!compute\_miller\_rabin@{compute\_miller\_rabin}}
\index{compute\_miller\_rabin@{compute\_miller\_rabin}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{compute\_miller\_rabin()}{compute\_miller\_rabin()}}
{\footnotesize\ttfamily bool Primality\+::compute\+\_\+miller\+\_\+rabin (\begin{DoxyParamCaption}\item[{int}]{d,  }\item[{int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00054}{54}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00054                                                  \{}
\DoxyCodeLine{00055     \textcolor{comment}{// Pick a random number in [2..n-\/2] Corner cases make sure that n > 4}}
\DoxyCodeLine{00056     \textcolor{keywordtype}{int} a = 2 + rand() \% (n -\/ 4);}
\DoxyCodeLine{00057  }
\DoxyCodeLine{00058     \textcolor{comment}{// Compute a\string^d \% n}}
\DoxyCodeLine{00059     \textcolor{keywordtype}{int} x = \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(a, d, n);}
\DoxyCodeLine{00060  }
\DoxyCodeLine{00061     \textcolor{keywordflow}{if} (x == 1  || x == n-\/1)}
\DoxyCodeLine{00062        \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00063  }
\DoxyCodeLine{00064     \textcolor{comment}{// Keep squaring x while one of the following doesn't}}
\DoxyCodeLine{00065     \textcolor{comment}{// happen}}
\DoxyCodeLine{00066     \textcolor{comment}{// (i)   d does not reach n-\/1}}
\DoxyCodeLine{00067     \textcolor{comment}{// (ii)  (x\string^2) \% n is not 1}}
\DoxyCodeLine{00068     \textcolor{comment}{// (iii) (x\string^2) \% n is not n-\/1}}
\DoxyCodeLine{00069     \textcolor{keywordflow}{while} (d != n -\/ 1) \{}
\DoxyCodeLine{00070         x = (x * x) \% n;}
\DoxyCodeLine{00071         d *= 2;}
\DoxyCodeLine{00072  }
\DoxyCodeLine{00073         \textcolor{keywordflow}{if} (x == 1)      }
\DoxyCodeLine{00074             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00075         \textcolor{keywordflow}{if} (x == n -\/ 1)    }
\DoxyCodeLine{00076             \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00077     \}}
\DoxyCodeLine{00078  }
\DoxyCodeLine{00079     \textcolor{comment}{// Return composite}}
\DoxyCodeLine{00080     \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00081 \}}

\end{DoxyCode}


References \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\+\_\+pow()}}.



Referenced by \mbox{\hyperlink{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}{miller\+\_\+rabin\+\_\+prime()}}.

\mbox{\Hypertarget{classPrimality_a334ba4925bdd37b5f6dfea94465afb1b}\label{classPrimality_a334ba4925bdd37b5f6dfea94465afb1b}} 
\index{Primality@{Primality}!ETF@{ETF}}
\index{ETF@{ETF}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{ETF()}{ETF()}}
{\footnotesize\ttfamily int Primality\+::\+ETF (\begin{DoxyParamCaption}\item[{unsigned int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00319}{319}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00319                                  \{}
\DoxyCodeLine{00320     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} result = 1;}
\DoxyCodeLine{00321     }
\DoxyCodeLine{00322     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} index = 2; unsigned(index) < n; index++) \{}
\DoxyCodeLine{00323         \textcolor{keywordflow}{if} (\mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}.\mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{op\_gcd}}(index, n) == 1) \{}
\DoxyCodeLine{00324             result++;}
\DoxyCodeLine{00325         \}}
\DoxyCodeLine{00326     \}}
\DoxyCodeLine{00327 }
\DoxyCodeLine{00328     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00329 \}}

\end{DoxyCode}


References \mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}, and \mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{mtpk\+::\+Basics\+::op\+\_\+gcd()}}.

\mbox{\Hypertarget{classPrimality_aa00343cb6fa77239717833d27f201f03}\label{classPrimality_aa00343cb6fa77239717833d27f201f03}} 
\index{Primality@{Primality}!is\_prime@{is\_prime}}
\index{is\_prime@{is\_prime}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{is\_prime()}{is\_prime()}}
{\footnotesize\ttfamily bool Primality\+::is\+\_\+prime (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00039}{39}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00039                               \{}
\DoxyCodeLine{00040     \textcolor{keywordflow}{if} (n <= 1)}
\DoxyCodeLine{00041         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00042  }
\DoxyCodeLine{00043     \textcolor{comment}{// Check from 2 to n-\/1}}
\DoxyCodeLine{00044     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} iter = 2; iter < n; iter++)}
\DoxyCodeLine{00045         \textcolor{keywordflow}{if} (n \% iter == 0)}
\DoxyCodeLine{00046             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00047  }
\DoxyCodeLine{00048     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00049 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPrimality_a7bd351acce09b9003b38519d992a25ed}\label{classPrimality_a7bd351acce09b9003b38519d992a25ed}} 
\index{Primality@{Primality}!jacobian\_number@{jacobian\_number}}
\index{jacobian\_number@{jacobian\_number}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{jacobian\_number()}{jacobian\_number()}}
{\footnotesize\ttfamily int Primality\+::jacobian\+\_\+number (\begin{DoxyParamCaption}\item[{long long}]{a,  }\item[{long long}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00130}{130}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00130                                                        \{}
\DoxyCodeLine{00131     \textcolor{keywordflow}{if} (!a)}
\DoxyCodeLine{00132         \textcolor{keywordflow}{return} 0;\textcolor{comment}{// (0/n) = 0}}
\DoxyCodeLine{00133  }
\DoxyCodeLine{00134     \textcolor{keywordtype}{int} ans = 1;}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     \textcolor{keywordflow}{if} (a < 0) \{}
\DoxyCodeLine{00137         a = -\/a; \textcolor{comment}{// (a/n) = (-\/a/n)*(-\/1/n)}}
\DoxyCodeLine{00138         \textcolor{keywordflow}{if} (n \% 4 == 3)}
\DoxyCodeLine{00139             ans = -\/ans; \textcolor{comment}{// (-\/1/n) = -\/1 if n = 3 (mod 4)}}
\DoxyCodeLine{00140     \}}
\DoxyCodeLine{00141  }
\DoxyCodeLine{00142     \textcolor{keywordflow}{if} (a == 1)}
\DoxyCodeLine{00143         \textcolor{keywordflow}{return} ans;\textcolor{comment}{// (1/n) = 1}}
\DoxyCodeLine{00144  }
\DoxyCodeLine{00145     \textcolor{keywordflow}{while} (a) \{}
\DoxyCodeLine{00146         \textcolor{keywordflow}{if} (a < 0) \{}
\DoxyCodeLine{00147             a = -\/a;\textcolor{comment}{// (a/n) = (-\/a/n)*(-\/1/n)}}
\DoxyCodeLine{00148             \textcolor{keywordflow}{if} (n \% 4 == 3)}
\DoxyCodeLine{00149                 ans = -\/ans;\textcolor{comment}{// (-\/1/n) = -\/1 if n = 3 (mod 4)}}
\DoxyCodeLine{00150         \}}
\DoxyCodeLine{00151  }
\DoxyCodeLine{00152         \textcolor{keywordflow}{while} (a \% 2 == 0) \{}
\DoxyCodeLine{00153             a = a / 2;}
\DoxyCodeLine{00154             \textcolor{keywordflow}{if} (n \% 8 == 3 || n \% 8 == 5)}
\DoxyCodeLine{00155                 ans = -\/ans;}
\DoxyCodeLine{00156         \}}
\DoxyCodeLine{00157         std::swap(a, n);}
\DoxyCodeLine{00158 }
\DoxyCodeLine{00159         \textcolor{keywordflow}{if} (a \% 4 == 3 \&\& n \% 4 == 3)}
\DoxyCodeLine{00160             ans = -\/ans;}
\DoxyCodeLine{00161 }
\DoxyCodeLine{00162         a = a \% n;}
\DoxyCodeLine{00163  }
\DoxyCodeLine{00164         \textcolor{keywordflow}{if} (a > n / 2)}
\DoxyCodeLine{00165             a = a -\/ n; }
\DoxyCodeLine{00166     \}}
\DoxyCodeLine{00167  }
\DoxyCodeLine{00168     \textcolor{keywordflow}{if} (n == 1)}
\DoxyCodeLine{00169         \textcolor{keywordflow}{return} ans;}
\DoxyCodeLine{00170  }
\DoxyCodeLine{00171     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00172 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{classPrimality_a8705a1468d5a995f5e835a0b992fae28}{solovoy\+\_\+strassen()}}.

\mbox{\Hypertarget{classPrimality_ab0da263da6230ef57e1d3ca3471b88d9}\label{classPrimality_ab0da263da6230ef57e1d3ca3471b88d9}} 
\index{Primality@{Primality}!miller\_rabin@{miller\_rabin}}
\index{miller\_rabin@{miller\_rabin}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{miller\_rabin()}{miller\_rabin()}}
{\footnotesize\ttfamily void Primality\+::miller\+\_\+rabin (\begin{DoxyParamCaption}\item[{int}]{inters,  }\item[{int}]{min\+\_\+val,  }\item[{int}]{max\+\_\+val }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00110}{110}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00110                                                                 \{}
\DoxyCodeLine{00111     std::cout << \textcolor{stringliteral}{"{}Primes between "{}} << min\_val << }
\DoxyCodeLine{00112                 \textcolor{stringliteral}{"{} and "{}} << max\_val << std::endl;}
\DoxyCodeLine{00113     \textcolor{comment}{//int d = iters -\/ 1;}}
\DoxyCodeLine{00114     \textcolor{comment}{//int min\_val = minimum;}}
\DoxyCodeLine{00115     \textcolor{comment}{//int max\_val = maximum;}}
\DoxyCodeLine{00116 }
\DoxyCodeLine{00117     \textcolor{comment}{// traverse from the min to max}}
\DoxyCodeLine{00118     \textcolor{keywordflow}{for} (; min\_val < max\_val; min\_val++) \{}
\DoxyCodeLine{00119     \textcolor{comment}{//while (min\_val < max\_val) \{}}
\DoxyCodeLine{00120         \textcolor{keywordflow}{if} (\mbox{\hyperlink{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}{miller\_rabin\_prime}}(min\_val, iters)) \{}
\DoxyCodeLine{00121             std::cout << min\_val << \textcolor{stringliteral}{"{} "{}};}
\DoxyCodeLine{00122         \}}
\DoxyCodeLine{00123     \}}
\DoxyCodeLine{00124     std::cout << \textcolor{stringliteral}{"{}\(\backslash\)n"{}};}
\DoxyCodeLine{00125 \}}

\end{DoxyCode}


References \mbox{\hyperlink{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}{miller\+\_\+rabin\+\_\+prime()}}.

\mbox{\Hypertarget{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}\label{classPrimality_a398e2ee039d0bdddb2b46914d48c88c2}} 
\index{Primality@{Primality}!miller\_rabin\_prime@{miller\_rabin\_prime}}
\index{miller\_rabin\_prime@{miller\_rabin\_prime}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{miller\_rabin\_prime()}{miller\_rabin\_prime()}}
{\footnotesize\ttfamily bool Primality\+::miller\+\_\+rabin\+\_\+prime (\begin{DoxyParamCaption}\item[{int}]{n,  }\item[{int}]{iters }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00083}{83}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083                                                    \{}
\DoxyCodeLine{00084     \textcolor{comment}{/*}}
\DoxyCodeLine{00085 \textcolor{comment}{     * this method will return true if n is prime, iters will determine}}
\DoxyCodeLine{00086 \textcolor{comment}{     * accuracy}}
\DoxyCodeLine{00087 \textcolor{comment}{     */}}
\DoxyCodeLine{00088     \textcolor{comment}{// these are corner cases}}
\DoxyCodeLine{00089     \textcolor{keywordflow}{if} (n <= 1 || n == 4)}
\DoxyCodeLine{00090         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00091     \textcolor{keywordflow}{if} (n <= 3)}
\DoxyCodeLine{00092         \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094     \textcolor{comment}{// odd will represent an odd number}}
\DoxyCodeLine{00095     \textcolor{keywordtype}{int} odd = n -\/ 1;}
\DoxyCodeLine{00096     \textcolor{keywordflow}{while} (odd \% 2 == 0) \{}
\DoxyCodeLine{00097         odd /= 2;}
\DoxyCodeLine{00098     \}}
\DoxyCodeLine{00099 }
\DoxyCodeLine{00100     \textcolor{comment}{// iterate given the iters paramater}}
\DoxyCodeLine{00101     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < iters; i ++) \{}
\DoxyCodeLine{00102         \textcolor{comment}{// compute using the Miller-\/Rabin method}}
\DoxyCodeLine{00103         \textcolor{keywordflow}{if} (!\mbox{\hyperlink{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}{compute\_miller\_rabin}}(odd, n)) \{}
\DoxyCodeLine{00104             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00105         \}}
\DoxyCodeLine{00106     \}}
\DoxyCodeLine{00107     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00108 \}}

\end{DoxyCode}


References \mbox{\hyperlink{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}{compute\+\_\+miller\+\_\+rabin()}}.



Referenced by \mbox{\hyperlink{classPrimality_ab0da263da6230ef57e1d3ca3471b88d9}{miller\+\_\+rabin()}}.

\mbox{\Hypertarget{classPrimality_a5c095723bcb653c92833b2424ce07479}\label{classPrimality_a5c095723bcb653c92833b2424ce07479}} 
\index{Primality@{Primality}!mod\_pow@{mod\_pow}}
\index{mod\_pow@{mod\_pow}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{mod\_pow()}{mod\_pow()}}
{\footnotesize\ttfamily long long int Primality\+::mod\+\_\+pow (\begin{DoxyParamCaption}\item[{long long int}]{base,  }\item[{long long int}]{exponent,  }\item[{long long int}]{mod }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00021}{21}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00023                            \{}
\DoxyCodeLine{00024 }
\DoxyCodeLine{00025     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} x = 1;}
\DoxyCodeLine{00026     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} y = base;}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028     \textcolor{keywordflow}{while} (exponent > 0) \{}
\DoxyCodeLine{00029         \textcolor{keywordflow}{if} (exponent \& 1) \{}
\DoxyCodeLine{00030             x = (x * y) \% mod;}
\DoxyCodeLine{00031         \}}
\DoxyCodeLine{00032         exponent = exponent >> 1;}
\DoxyCodeLine{00033         y = (y * y) \% mod;}
\DoxyCodeLine{00034     \}}
\DoxyCodeLine{00035 }
\DoxyCodeLine{00036     \textcolor{keywordflow}{return} x;}
\DoxyCodeLine{00037 \}}

\end{DoxyCode}


Referenced by \mbox{\hyperlink{classPrimality_aa37d71124bce59af692d285d7c370983}{carmichael\+\_\+num()}}, \mbox{\hyperlink{classPrimality_a4928335bf2bf8e0a123f46e33b0a4b47}{compute\+\_\+miller\+\_\+rabin()}}, \mbox{\hyperlink{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}{pollard\+\_\+rho()}}, and \mbox{\hyperlink{classPrimality_a8705a1468d5a995f5e835a0b992fae28}{solovoy\+\_\+strassen()}}.

\mbox{\Hypertarget{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}\label{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}} 
\index{Primality@{Primality}!pollard\_rho@{pollard\_rho}}
\index{pollard\_rho@{pollard\_rho}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{pollard\_rho()}{pollard\_rho()}}
{\footnotesize\ttfamily long long int Primality\+::pollard\+\_\+rho (\begin{DoxyParamCaption}\item[{long long int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00258}{258}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00258                                                     \{}
\DoxyCodeLine{00259     \textcolor{comment}{/* initialize random seed */}}
\DoxyCodeLine{00260     srand (time(NULL));}
\DoxyCodeLine{00261  }
\DoxyCodeLine{00262     \textcolor{comment}{/* no prime divisor for 1 */}}
\DoxyCodeLine{00263     \textcolor{keywordflow}{if} (n == 1) }
\DoxyCodeLine{00264         \textcolor{keywordflow}{return} n;}
\DoxyCodeLine{00265  }
\DoxyCodeLine{00266     \textcolor{comment}{/* even number means one of the divisors is 2 */}}
\DoxyCodeLine{00267     \textcolor{keywordflow}{if} (n \% 2 == 0) }
\DoxyCodeLine{00268         \textcolor{keywordflow}{return} 2;}
\DoxyCodeLine{00269  }
\DoxyCodeLine{00270     \textcolor{comment}{/* we will pick from the range [2, N) */}}
\DoxyCodeLine{00271     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} x = (rand() \% (n -\/ 2)) + 2;}
\DoxyCodeLine{00272     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} y = x;}
\DoxyCodeLine{00273  }
\DoxyCodeLine{00274     \textcolor{comment}{/* the constant in f(x).}}
\DoxyCodeLine{00275 \textcolor{comment}{     * Algorithm can be re-\/run with a different c}}
\DoxyCodeLine{00276 \textcolor{comment}{     * if it throws failure for a composite. */}}
\DoxyCodeLine{00277     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} c = (rand() \% (n -\/ 1)) + 1;}
\DoxyCodeLine{00278 }
\DoxyCodeLine{00279     \textcolor{comment}{/* Initialize candidate divisor (or result) */}}
\DoxyCodeLine{00280     \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \textcolor{keywordtype}{int} divisor = 1; }
\DoxyCodeLine{00281  }
\DoxyCodeLine{00282     \textcolor{comment}{/* until the prime factor isn't obtained.}}
\DoxyCodeLine{00283 \textcolor{comment}{       If n is prime, return n */}}
\DoxyCodeLine{00284     \textcolor{keywordflow}{while} (divisor == 1) \{}
\DoxyCodeLine{00285         \textcolor{comment}{/* Tortoise Move: x(i+1) = f(x(i)) */}}
\DoxyCodeLine{00286         \textcolor{comment}{// take power }}
\DoxyCodeLine{00287         \textcolor{comment}{// calculate modulus}}
\DoxyCodeLine{00288         x = (\mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(x, 2, n) + c + n) \% n;}
\DoxyCodeLine{00289  }
\DoxyCodeLine{00290         \textcolor{comment}{/* Hare Move: y(i+1) = f(f(y(i))) */}}
\DoxyCodeLine{00291         y = (\mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(y, 2, n) + c + n) \% n;}
\DoxyCodeLine{00292         y = (\mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(y, 2, n) + c + n) \% n;}
\DoxyCodeLine{00293  }
\DoxyCodeLine{00294         \textcolor{comment}{/* check gcd of |x-\/y| and n */}}
\DoxyCodeLine{00295         divisor = \mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}.\mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{op\_gcd}}(abs(x -\/ y), n);}
\DoxyCodeLine{00296         \textcolor{comment}{//divisor = std::\_\_gcd(abs(x -\/ y), n);}}
\DoxyCodeLine{00297         \textcolor{comment}{/* retry if the algorithm fails to find prime factor}}
\DoxyCodeLine{00298 \textcolor{comment}{         * with chosen x and c */}}
\DoxyCodeLine{00299         \textcolor{keywordflow}{if} (divisor == n) }
\DoxyCodeLine{00300             \textcolor{keywordflow}{return} \mbox{\hyperlink{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}{pollard\_rho}}(n);}
\DoxyCodeLine{00301     \}}
\DoxyCodeLine{00302  }
\DoxyCodeLine{00303     \textcolor{keywordflow}{return} divisor;}
\DoxyCodeLine{00304 \}}

\end{DoxyCode}


References \mbox{\hyperlink{primes_8cpp_aa984413d595262e996d3f8b4fb7f82b6}{ba}}, \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\+\_\+pow()}}, \mbox{\hyperlink{classmtpk_1_1Basics_aea4f43ee216de88e00d487a4598fcea4}{mtpk\+::\+Basics\+::op\+\_\+gcd()}}, and \mbox{\hyperlink{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}{pollard\+\_\+rho()}}.



Referenced by \mbox{\hyperlink{classPrimality_a626afbe841185a8f29afaddbfc2c41b8}{pollard\+\_\+rho()}}.

\mbox{\Hypertarget{classPrimality_a0696ffc0cfa107f7231349e1a6f6a72c}\label{classPrimality_a0696ffc0cfa107f7231349e1a6f6a72c}} 
\index{Primality@{Primality}!sieve\_of\_eratosthenes@{sieve\_of\_eratosthenes}}
\index{sieve\_of\_eratosthenes@{sieve\_of\_eratosthenes}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{sieve\_of\_eratosthenes()}{sieve\_of\_eratosthenes()}}
{\footnotesize\ttfamily void Primality\+::sieve\+\_\+of\+\_\+eratosthenes (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00218}{218}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00218                                            \{}
\DoxyCodeLine{00219     \textcolor{comment}{// Create a boolean array "{}prime[0..n]"{} and initialize}}
\DoxyCodeLine{00220     \textcolor{comment}{// all entries it as true. A value in prime[i] will}}
\DoxyCodeLine{00221     \textcolor{comment}{// finally be false if i is Not a prime, else true.}}
\DoxyCodeLine{00222     \textcolor{keywordtype}{bool} prime[n + 1];}
\DoxyCodeLine{00223     memset(prime, \textcolor{keyword}{true}, \textcolor{keyword}{sizeof}(prime));}
\DoxyCodeLine{00224  }
\DoxyCodeLine{00225     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 2; p * p <= n; p++) \{}
\DoxyCodeLine{00226         \textcolor{comment}{// If prime[p] is not changed, then it is a prime}}
\DoxyCodeLine{00227         \textcolor{keywordflow}{if} (prime[p] == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{00228             \textcolor{comment}{// Update all multiples of p greater than or}}
\DoxyCodeLine{00229             \textcolor{comment}{// equal to the square of it numbers which are}}
\DoxyCodeLine{00230             \textcolor{comment}{// multiple of p and are less than p\string^2 are}}
\DoxyCodeLine{00231             \textcolor{comment}{// already been marked.}}
\DoxyCodeLine{00232             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = p * p; i <= n; i += p)}
\DoxyCodeLine{00233                 prime[i] = \textcolor{keyword}{false};}
\DoxyCodeLine{00234         \}}
\DoxyCodeLine{00235     \}}
\DoxyCodeLine{00236  }
\DoxyCodeLine{00237     \textcolor{comment}{// Print all prime numbers}}
\DoxyCodeLine{00238     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} p = 2; p <= n; p++)}
\DoxyCodeLine{00239         \textcolor{keywordflow}{if} (prime[p])}
\DoxyCodeLine{00240             std::cout << p << \textcolor{stringliteral}{"{} "{}} << std::endl;}
\DoxyCodeLine{00241 \}}

\end{DoxyCode}
\mbox{\Hypertarget{classPrimality_a8705a1468d5a995f5e835a0b992fae28}\label{classPrimality_a8705a1468d5a995f5e835a0b992fae28}} 
\index{Primality@{Primality}!solovoy\_strassen@{solovoy\_strassen}}
\index{solovoy\_strassen@{solovoy\_strassen}!Primality@{Primality}}
\doxysubsubsection{\texorpdfstring{solovoy\_strassen()}{solovoy\_strassen()}}
{\footnotesize\ttfamily bool Primality\+::solovoy\+\_\+strassen (\begin{DoxyParamCaption}\item[{long long}]{p,  }\item[{int}]{iters }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{primes_8cpp_source_l00178}{178}} of file \mbox{\hyperlink{primes_8cpp_source}{primes.\+cpp}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00178                                                        \{}
\DoxyCodeLine{00179     \textcolor{keywordflow}{if} (p < 2)}
\DoxyCodeLine{00180         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00181     }
\DoxyCodeLine{00182     \textcolor{keywordflow}{if} (p != 2 \&\& p \% 2 == 0)}
\DoxyCodeLine{00183         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00184  }
\DoxyCodeLine{00185     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < iters; i++) \{}
\DoxyCodeLine{00186         \textcolor{comment}{// Generate a random number a}}
\DoxyCodeLine{00187         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} a = rand() \% (p -\/ 1) + 1;}
\DoxyCodeLine{00188         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} jacobian = (p + \mbox{\hyperlink{classPrimality_a7bd351acce09b9003b38519d992a25ed}{jacobian\_number}}(a, p)) \% p;}
\DoxyCodeLine{00189         \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} mod = \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\_pow}}(a, (p -\/ 1) / 2, p);}
\DoxyCodeLine{00190  }
\DoxyCodeLine{00191         \textcolor{keywordflow}{if} (!jacobian || mod != jacobian)}
\DoxyCodeLine{00192             \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{00193     \}}
\DoxyCodeLine{00194     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{00195 \}}

\end{DoxyCode}


References \mbox{\hyperlink{classPrimality_a7bd351acce09b9003b38519d992a25ed}{jacobian\+\_\+number()}}, and \mbox{\hyperlink{classPrimality_a5c095723bcb653c92833b2424ce07479}{mod\+\_\+pow()}}.



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
include/number\+\_\+theory/\mbox{\hyperlink{primes_8hpp}{primes.\+hpp}}\item 
modules/number\+\_\+theory/\mbox{\hyperlink{primes_8cpp}{primes.\+cpp}}\end{DoxyCompactItemize}
